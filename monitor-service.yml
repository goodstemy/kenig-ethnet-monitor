version: '3'

services:
  monitor:
    image: buythewhale/ethstats_monitor
    volumes:
      - ./monitor/app.json:/home/ethnetintel/eth-net-intelligence-api/app.json:ro
    networks:
      - app_net

  dashboard:
    image: buythewhale/ethstats
    volumes:
      - ./dashboard/ws_secret.json:/eth-netstats/ws_secret.json:ro
    ports:
      - 3001:3000
    networks:
      - app_net

  explorer:
    image: goodstemy/explorer
    ports:
      - 3002:3000
    depends_on:
      - explorer-grabber
      - mongo
    networks:
      - backend

  explorer-grabber:
    image: goodstemy/explorer-grabber
    depends_on:
      - mongo
    networks:
      - backend
    environment:
      - MONGO_URI=mongodb://mongo:27017/blockDB

  mongo:
    image: mongo:latest
    ports:
      - 27017:27017
    volumes:
      - ./data:/data/db
    networks:
      - backend

networks:
  app_net:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.16.1.1/24
  backend:
    driver: "bridge"
